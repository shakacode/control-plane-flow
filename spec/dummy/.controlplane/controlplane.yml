aliases:
  common: &common
    allow_org_override_by_env: true

    default_location: aws-us-east-2

    one_off_workload: rails
    app_workloads:
      - rails
    additional_workloads:
      - postgres

apps:
  dummy-test-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    image_retention_max_qty: 3
    image_retention_days: 30
    stale_app_image_deployed_days: 30
    upstream: dummy-test-upstream
    release_script: release.sh
    default_domain: cpl.rafaelgomes.xyz
    maintenance_workload: maintenance
    setup_app_templates:
      - app
      - rails
      - postgres

  dummy-test-with-nothing-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true

  dummy-test-default-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    default_domain: cpl.rafaelgomes.xyz
    setup_app_templates:
      - app

  dummy-test-with-rails-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    setup_app_templates:
      - app
      - rails

  dummy-test-full-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    default_domain: cpl.rafaelgomes.xyz
    setup_app_templates:
      - app
      - rails
      - postgres
      - maintenance

  dummy-test-with-nonexistent-dockerfile-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    dockerfile: Dockerfile.nonexistent

  dummy-test-with-invalid-dockerfile-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    dockerfile: Dockerfile.invalid

  dummy-test-with-image-retention-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    image_retention_max_qty: 3
    image_retention_days: 30
    setup_app_templates:
      - app

  dummy-test-with-image-retention-max-qty-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    image_retention_max_qty: 3

  dummy-test-with-image-retention-days-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    image_retention_days: 30

  dummy-test-with-stale-app-image-deployed-days-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    stale_app_image_deployed_days: 30

  dummy-test-with-undefined-upstream-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    upstream: undefined
  
  dummy-test-without-org-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    cpln_org:

  dummy-test-with-rails-with-non-app-image-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    release_script: release.sh
    app_workloads:
      - rails
      - rails-with-non-app-image
    setup_app_templates:
      - app
      - rails
      - postgres
      - rails-with-non-app-image

  dummy-test-with-nonexistent-release-script-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    release_script: release-nonexistent.sh

  dummy-test-with-invalid-release-script-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    upstream: dummy-test-upstream
    release_script: release-invalid.sh

  dummy-test-with-external-maintenance-image-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    maintenance_workload: maintenance-with-external-image

  dummy-test-with-fix-terminal-size-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    fix_terminal_size: true

  dummy-test-without-identity-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    setup_app_templates:
      - app-without-identity

  dummy-test-without-policy-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    secrets_policy_name: nonexistent
    setup_app_templates:
      - app

  dummy-test-info-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true

  dummy-test-info-with-nothing-missing-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    setup_app_templates:
      - app
      - rails
      - postgres

  dummy-test-info-with-missing-apps-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true

  dummy-test-info-with-missing-workloads-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    setup_app_templates:
      - app
      - rails

  dummy-test-info-with-extra-workloads-{GLOBAL_IDENTIFIER}:
    <<: *common

    match_if_app_name_starts_with: true
    setup_app_templates:
      - app
      - rails
      - postgres
      - rails-with-non-app-image
